@baseUrl = {{$dotenv baseUrl}}

### ========================================
### COVER LETTER GENERATION - SUCCESS CASES
### ========================================

### Generate Cover Letter from CV ID (Primary Method)
### Optional: Add X-User-Id header to use your saved API key (BYOK pattern)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "We are looking for a Senior Software Engineer with 5+ years of experience in .NET and C#. The ideal candidate should have experience with microservices architecture, REST APIs, and cloud technologies (Azure/AWS). Strong knowledge of SQL databases and Entity Framework is required. Experience with Docker and Kubernetes is a plus.",
  "cvId": "YOUR_CV_ID_HERE",
  "idempotencyKey": "cover-letter-gen-001"
}

### Generate Cover Letter from Direct Text (Convenience Method)
### Optional: Add X-User-Id: your-user-id to use your saved API key
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "We are looking for a Senior Software Engineer with 5+ years of experience in .NET and C#. The ideal candidate should have experience with microservices architecture, REST APIs, and cloud technologies (Azure/AWS). Strong knowledge of SQL databases and Entity Framework is required. Experience with Docker and Kubernetes is a plus.",
  "cvText": "John Doe - Senior Software Developer\n\nExperience:\n- 6 years of software development experience\n- Proficient in C#, .NET Core, ASP.NET\n- Built microservices using Docker and Kubernetes\n- Extensive experience with SQL Server and PostgreSQL\n- Worked with Azure cloud services\n- Led a team of 4 developers\n\nSkills: C#, .NET, ASP.NET Core, Entity Framework, SQL Server, PostgreSQL, Docker, Kubernetes, Azure, REST APIs, Git\n\nEducation: BSc Computer Science"
}

### Generate Cover Letter - Junior Position (Direct Text)
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "Junior Developer position at a startup.",
  "cvText": "Jane Smith - Recent Graduate with BSc Computer Science"
}

### Generate Cover Letter - Custom Template (Direct Text)
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "Junior Developer position at a startup. We need someone eager to learn, with basic programming knowledge.",
  "cvText": "Jane Smith - Recent Graduate\n\nEducation: BSc Computer Science (2024)\n\nProjects:\n- Built a web app using React and Node.js\n- Created a mobile app using Flutter\n\nSkills: JavaScript, Python, React, Node.js, Git",
  "customPromptTemplate": "Write a SHORT and enthusiastic cover letter (2 paragraphs max) for a junior developer position.",
  "promptMode": "Append"
}

### Generate Cover Letter - Override Mode (Replace Default Prompt)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "Senior .NET Developer position",
  "cvId": "YOUR_CV_ID_HERE",
  "customPromptTemplate": "Write a professional cover letter.\n\nJob: {0}\nCV: {1}\n\nFocus on technical skills only. Be concise.",
  "promptMode": "Override"
}

### ========================================
### IDEMPOTENCY TESTS
### ========================================

### Idempotency - First Call with CV ID (should call Groq API)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "Software Engineer at Tech Company",
  "cvId": "YOUR_CV_ID_HERE",
  "idempotencyKey": "test-key-12345"
}

### Idempotency - Second Call (should return cached response)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "Software Engineer at Tech Company",
  "cvId": "YOUR_CV_ID_HERE",
  "idempotencyKey": "test-key-12345"
}

### Idempotency with Direct Text - First Call
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "Software Engineer at Tech Company",
  "cvText": "John Doe - 5 years experience in .NET and C#",
  "idempotencyKey": "text-key-12345"
}

### Idempotency with Direct Text - Second Call (cached)
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "Software Engineer at Tech Company",
  "cvText": "John Doe - 5 years experience in .NET and C#",
  "idempotencyKey": "text-key-12345"
}

### ========================================
### VALIDATION ERROR TESTS
### ========================================

### Validation Error - Empty Job Description (CV ID)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "",
  "cvId": "some-cv-id"
}

### Validation Error - Missing CV ID
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "Software Developer position"
}

### Validation Error - Empty CV Text
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "jobDescription": "Software Developer position",
  "cvText": ""
}

### Validation Error - Missing Job Description
POST {{baseUrl}}/api/v1/cover-letters/generate-from-text
Content-Type: application/json

{
  "cvText": "John Doe - Developer with 5 years experience"
}

### Validation Error - Whitespace Only
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "   ",
  "cvText": "   "
}

### ========================================
### HTTP ERROR TESTS
### ========================================

### Wrong Content-Type (should return 415)
POST {{baseUrl}}/api/v1/cover-letters/generate
Content-Type: text/plain

jobDescription=Test&cvText=Test

### Invalid API Version (should return 404)
POST {{baseUrl}}/api/v99/cover-letters/generate
Content-Type: application/json

{
  "jobDescription": "Test",
  "cvText": "Test"
}

### Non-existent Endpoint (should return 404)
POST {{baseUrl}}/api/v1/cover-letters/unknown
Content-Type: application/json

{
  "jobDescription": "Test",
  "cvText": "Test"
}

### Wrong HTTP Method (should return 405)
GET {{baseUrl}}/api/v1/cover-letters/generate
Accept: application/json

###
